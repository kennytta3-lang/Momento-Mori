<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memento Mori Widget</title>
    <style>
        :root {
            --bg-color: #191919; 
            --text-color: #ffffff;
            --box-empty: #2f2f2f;
            --box-filled: #e0e0e0;
            --box-current: #ff5252;
            --accent: #4a90e2;
        }

        /* This is the magic part: 
           It sets the body to use 100% of the widget height 
           and organizes content in a vertical column.
        */
        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 15px;
            height: 100vh; /* Full Height of the Notion Block */
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* Prevents double scrollbars */
        }

        /* Header Section (Fixed at Top) */
        header {
            flex-shrink: 0; /* Don't let this shrink */
            text-align: center;
        }

        h1 { 
            font-size: 1.5rem; 
            margin: 0 0 5px 0; 
            font-weight: 800; 
            letter-spacing: 3px; 
            color: #ffffff;
            text-transform: uppercase;
        }

        p { 
            font-size: 0.85rem; 
            color: #ccc; 
            margin: 0 0 15px 0; 
        }

        /* Controls (Fixed at Top) */
        .controls {
            margin-bottom: 10px;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-shrink: 0;
        }

        input[type="date"] {
            padding: 5px;
            background: #2f2f2f;
            color: #fff;
            border: 1px solid #444;
            border-radius: 4px;
            font-family: inherit;
            font-size: 0.8rem;
        }

        button {
            padding: 5px 15px;
            background-color: #333;
            color: #fff;
            border: 1px solid #444;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.8rem;
            font-weight: bold;
            transition: background 0.2s;
        }

        button:hover { background-color: #444; }
        button.primary { background-color: var(--accent); border-color: var(--accent); }

        /* The Grid (Flexible Middle) 
           It grows to fill available space (flex: 1)
           It scrolls internally if the window is too short (overflow-y: auto)
        */
        .life-grid-container {
            flex: 1; 
            overflow-y: auto; 
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Start grid from top */
            padding-right: 5px; /* Room for scrollbar */
        }

        .life-grid {
            display: flex;
            flex-wrap: wrap;
            width: 100%;
            gap: 3px; 
            justify-content: center; 
            align-content: flex-start;
        }

        .week-box {
            width: 7px; 
            height: 7px; 
            background-color: var(--box-empty);
            border-radius: 1px;
        }

        .week-box.filled { background-color: var(--box-filled); }
        
        .week
